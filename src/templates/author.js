import React from "react"
import { Link, graphql } from "gatsby"
import kebabCase from "lodash/kebabCase"

import Layout from "../components/layout"
import SEO from "../components/seo"

const Author = ({ pageContext, data }) => {
  const { author } = pageContext
  const { edges, totalCount } = data.allContentfulBlogPost
  const {
    name,
    intro,
    image,
    facebook,
    github,
    linkedin,
    website,
    instagram,
  } = data.contentfulAuthor
  return (
    <Layout>
      <SEO
        title={author}
        url={`https://blogbudz.com/authors/${kebabCase(name)}`}
        description={intro.intro}
        image={image.fluid.src}
        keywords={[
          `blogbudz`,
          `blogging sites`,
          `latest technology news`,
          `${name}`,
          `tech author`,
          `blogbudz author`,
        ]}
      />
      <div className="section-profile">
        <div
          className="profile-wrap is-cover"
          style={{
            backgroundImage: `url(${image.fluid.src})`,
          }}
        >
          <h1>{author}</h1>
          <div className="author-social">
            <a
              href={website}
              aria-label="link Website"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                role="img"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M12.2788278,2.10765437 C14.8256905,-0.449446705 18.9706955,-0.76072067 21.6820313,1.61965243 C24.6552536,4.23057191 24.7681965,8.79131732 22.0208601,11.550601 L17.5906743,15.9986187 C15.4249939,18.1731728 12.0988251,18.8735392 9.35219455,17.5128066 C8.41194479,17.0473502 7.68416888,16.4058931 7.11592484,15.6567992 C6.89780384,15.368798 6.92109832,14.9629782 7.17592577,14.7069772 L8.21005933,13.6691549 C8.52347591,13.3542446 9.02677778,13.4276994 9.28301701,13.7913372 C9.46019621,14.0422473 9.66702292,14.2735209 9.90490894,14.482249 C11.4797567,15.8669818 13.9002645,15.6575264 15.3805226,14.1709751 L20.005535,9.52659297 C21.6241481,7.90113196 21.5281466,5.19421211 19.7154128,3.69747888 C18.1349179,2.39274642 15.7864112,2.63347465 14.3393301,4.08584406 L13.6376723,4.79057414 C13.3595503,5.06984797 12.9077787,5.06984797 12.6296567,4.79057414 L11.6223471,3.77893375 C11.3442252,3.49965991 11.3442252,3.0465672 11.6223471,2.76729336 L12.2788278,2.10765437 Z M15.2534618,9.66113896 C14.9703987,9.94477645 14.5228624,9.92804911 14.2362697,9.64877528 C14.0379137,9.45531996 13.8169691,9.28077381 13.5741419,9.12804593 C12.0077648,8.14258747 9.94514485,8.49822525 8.63853651,9.81023046 L4.11870225,14.3491576 C2.67162116,15.801527 2.43232336,18.1600819 3.73116688,19.7469973 C5.22201335,21.5673681 7.91781954,21.6640958 9.53713857,20.0386348 L10.3623277,19.2095406 C10.6411556,18.9302667 11.0922213,18.9302667 11.3703433,19.2095406 L12.3776529,20.221181 C12.6557748,20.5004548 12.6557748,20.9535475 12.3776529,21.2328214 L11.7211722,21.8924603 C9.17430946,24.4495614 5.0293045,24.7608354 2.31796866,22.379735 C-0.655253565,19.7688155 -0.768196479,15.2087974 1.97913991,12.4495137 L6.39309019,8.01749606 C7.98558528,6.41821697 10.2119725,5.55712264 12.4489481,5.82257824 C14.095797,6.01748811 15.324757,6.70258174 16.2607714,7.63567636 C16.5403052,7.9149502 16.5374816,8.37167929 16.2586538,8.6516804 L15.2534618,9.66113896 Z"></path>
              </svg>
            </a>
            <a
              href={facebook}
              aria-label="link Facebook"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                className="global-svg"
                role="img"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M23.9981 11.9991C23.9981 5.37216 18.626 0 11.9991 0C5.37216 0 0 5.37216 0 11.9991C0 17.9882 4.38789 22.9522 10.1242 23.8524V15.4676H7.07758V11.9991H10.1242V9.35553C10.1242 6.34826 11.9156 4.68714 14.6564 4.68714C15.9692 4.68714 17.3424 4.92149 17.3424 4.92149V7.87439H15.8294C14.3388 7.87439 13.8739 8.79933 13.8739 9.74824V11.9991H17.2018L16.6698 15.4676H13.8739V23.8524C19.6103 22.9522 23.9981 17.9882 23.9981 11.9991Z"></path>
              </svg>
            </a>
            <a
              href={linkedin}
              aria-label="link LinkedIn"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                className="global-svg"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 23.77 23.78"
              >
                <rect x="0.47" y="7.93" width="4.91" height="15.85" />
                <path d="M2.9,5.85A2.91,2.91,0,0,0,5.8,2.93,2.9,2.9,0,1,0,2.9,5.85Z" />
                <path d="M13.22,15.46c0-2.23,1-3.56,3-3.56,1.81,0,2.68,1.28,2.68,3.56v8.32h4.88v-10c0-4.24-2.41-6.3-5.77-6.3a5.54,5.54,0,0,0-4.78,2.62V7.93H8.52V23.78h4.7Z" />
              </svg>
            </a>
            <a
              href={instagram}
              aria-label="link Instagram"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                className="global-svg"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 26 26"
              >
                <path d="M13,2.34c3.47,0,3.88,0,5.26.08a7.21,7.21,0,0,1,2.41.45,3.93,3.93,0,0,1,1.5,1,4.13,4.13,0,0,1,1,1.49,7.22,7.22,0,0,1,.45,2.42c.06,1.37.07,1.78.07,5.25s0,3.89-.07,5.26a7.21,7.21,0,0,1-.45,2.41,4.26,4.26,0,0,1-2.47,2.47,7.21,7.21,0,0,1-2.41.45c-1.38.06-1.79.07-5.26.07s-3.88,0-5.25-.07a7.22,7.22,0,0,1-2.42-.45,4.13,4.13,0,0,1-1.49-1,3.93,3.93,0,0,1-1-1.5,7.21,7.21,0,0,1-.45-2.41c-.06-1.37-.08-1.79-.08-5.26s0-3.88.08-5.25a7.22,7.22,0,0,1,.45-2.42,3.89,3.89,0,0,1,1-1.49,3.89,3.89,0,0,1,1.49-1,7.22,7.22,0,0,1,2.42-.45c1.37-.06,1.78-.08,5.25-.08M13,0C9.47,0,9,0,7.64.08a9.45,9.45,0,0,0-3.15.6,6.34,6.34,0,0,0-2.31,1.5A6.42,6.42,0,0,0,.68,4.49a9.45,9.45,0,0,0-.6,3.15C0,9,0,9.47,0,13s0,4,.08,5.36a9.52,9.52,0,0,0,.6,3.16,6.39,6.39,0,0,0,1.5,2.3,6.21,6.21,0,0,0,2.31,1.5,9.68,9.68,0,0,0,3.15.61C9,26,9.47,26,13,26s4,0,5.36-.07a9.75,9.75,0,0,0,3.16-.61,6.26,6.26,0,0,0,2.3-1.5,6.39,6.39,0,0,0,1.5-2.3,9.75,9.75,0,0,0,.61-3.16C26,17,26,16.53,26,13s0-4-.07-5.36a9.68,9.68,0,0,0-.61-3.15,6.42,6.42,0,0,0-1.5-2.31,6.39,6.39,0,0,0-2.3-1.5,9.52,9.52,0,0,0-3.16-.6C17,0,16.53,0,13,0" />
                <path d="M13,6.33A6.68,6.68,0,1,0,19.68,13,6.66,6.66,0,0,0,13,6.33m0,11A4.34,4.34,0,1,1,17.34,13,4.33,4.33,0,0,1,13,17.34" />
                <path d="M21.5,6.06A1.56,1.56,0,1,1,19.94,4.5,1.56,1.56,0,0,1,21.5,6.06" />
              </svg>
            </a>
            <a
              href={github}
              aria-label="link Github"
              target="_blank"
              rel="noopener noreferrer"
            >
              <svg
                className="global-svg"
                role="img"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 438.549 438.549"
              >
                <path
                  d="M409.132,114.573c-19.608-33.596-46.205-60.194-79.798-79.8C295.736,15.166,259.057,5.365,219.271,5.365
		c-39.781,0-76.472,9.804-110.063,29.408c-33.596,19.605-60.192,46.204-79.8,79.8C9.803,148.168,0,184.854,0,224.63
		c0,47.78,13.94,90.745,41.827,128.906c27.884,38.164,63.906,64.572,108.063,79.227c5.14,0.954,8.945,0.283,11.419-1.996
		c2.475-2.282,3.711-5.14,3.711-8.562c0-0.571-0.049-5.708-0.144-15.417c-0.098-9.709-0.144-18.179-0.144-25.406l-6.567,1.136
		c-4.187,0.767-9.469,1.092-15.846,1c-6.374-0.089-12.991-0.757-19.842-1.999c-6.854-1.231-13.229-4.086-19.13-8.559
		c-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559
		c-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-0.951-2.568-2.098-3.711-3.429c-1.142-1.331-1.997-2.663-2.568-3.997
		c-0.572-1.335-0.098-2.43,1.427-3.289c1.525-0.859,4.281-1.276,8.28-1.276l5.708,0.853c3.807,0.763,8.516,3.042,14.133,6.851
		c5.614,3.806,10.229,8.754,13.846,14.842c4.38,7.806,9.657,13.754,15.846,17.847c6.184,4.093,12.419,6.136,18.699,6.136
		c6.28,0,11.704-0.476,16.274-1.423c4.565-0.952,8.848-2.383,12.847-4.285c1.713-12.758,6.377-22.559,13.988-29.41
		c-10.848-1.14-20.601-2.857-29.264-5.14c-8.658-2.286-17.605-5.996-26.835-11.14c-9.235-5.137-16.896-11.516-22.985-19.126
		c-6.09-7.614-11.088-17.61-14.987-29.979c-3.901-12.374-5.852-26.648-5.852-42.826c0-23.035,7.52-42.637,22.557-58.817
		c-7.044-17.318-6.379-36.732,1.997-58.24c5.52-1.715,13.706-0.428,24.554,3.853c10.85,4.283,18.794,7.952,23.84,10.994
		c5.046,3.041,9.089,5.618,12.135,7.708c17.705-4.947,35.976-7.421,54.818-7.421s37.117,2.474,54.823,7.421l10.849-6.849
		c7.419-4.57,16.18-8.758,26.262-12.565c10.088-3.805,17.802-4.853,23.134-3.138c8.562,21.509,9.325,40.922,2.279,58.24
		c15.036,16.18,22.559,35.787,22.559,58.817c0,16.178-1.958,30.497-5.853,42.966c-3.9,12.471-8.941,22.457-15.125,29.979
		c-6.191,7.521-13.901,13.85-23.131,18.986c-9.232,5.14-18.182,8.85-26.84,11.136c-8.662,2.286-18.415,4.004-29.263,5.146
		c9.894,8.562,14.842,22.077,14.842,40.539v60.237c0,3.422,1.19,6.279,3.572,8.562c2.379,2.279,6.136,2.95,11.276,1.995
		c44.163-14.653,80.185-41.062,108.068-79.226c27.88-38.161,41.825-81.126,41.825-128.906
		C438.536,184.851,428.728,148.168,409.132,114.573z"
                />
              </svg>
            </a>
          </div>
          <h2>{intro.intro}</h2>
          <div className="posts-number" style={{ marginTop: "20px" }}>
            <svg
              role="img"
              viewBox="0 0 24 24"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path d="M14.4429008,23.7744902 L8.34787826,17.944169 L2.25285576,23.7744902 C2.10780746,23.8894094 1.94171423,23.9595562 1.77120393,23.9868714 C1.71719951,23.9954904 1.66181846,24 1.6053913,24 C0.733763643,24 4.4408921e-16,23.3090623 4.4408921e-16,22.42036 L4.4408921e-16,1.25412932 C4.4408921e-16,0.723799848 0.28433197,0.244699969 0.822236618,0.0663515255 C0.982404415,0.0132460589 1.12666656,-0.00204032517 1.28186513,0.000211809426 C1.35304676,0.0012447482 1.38046168,0.0031905923 1.50305219,0.0133965248 C1.55929016,0.0180784608 1.58577038,0.0196251488 1.6053913,0.0196251488 L15.0902609,0.0196251488 C15.1098818,0.0196251488 15.136362,0.0180784608 15.1926,0.0133965248 C15.3151905,0.0031905923 15.3426054,0.0012447482 15.413787,0.000211809426 C15.5689856,-0.00204032517 15.7132478,0.0132460589 15.8734156,0.0663515255 C16.4113202,0.244699969 16.6956522,0.723799848 16.6956522,1.25412932 L16.6956522,22.42036 C16.6956522,23.3090623 15.9618885,24 15.0902609,24 C15.0061199,24 14.9243049,23.9899728 14.8459304,23.9710405 C14.7032293,23.9368156 14.5655424,23.871657 14.4429008,23.7744902 Z"></path>
            </svg>{" "}
            <span>{totalCount} posts</span>
          </div>
        </div>
      </div>
      <div id="loop" className="section-loop wrap">
        <div className="items-wrap flex">
          {edges.map(({ node }) => {
            return (
              <div className="item-wrap flex is-image" key={node.id}>
                <article>
                  <Link
                    to={`/${node.slug}/`}
                    className="item-link-overlay"
                    aria-label={node.title}
                  ></Link>
                  <div
                    className="item-image"
                    style={{
                      backgroundImage: `url(${node.featuredImage.fluid.src})`,
                    }}
                  ></div>
                  <h2>
                    <Link to={`/${node.slug}/`} className="white">
                      {node.title}
                    </Link>
                  </h2>

                  <div className="item-meta white is-primary-tag">
                    <span>by</span>{" "}
                    <Link to={`/authors/${kebabCase(node.author.name)}/`}>
                      {node.author.name}
                    </Link>{" "}
                    <time dateTime={node.updatedAt}>{node.updatedAt}</time>
                  </div>

                  {node.categories.map(categories => (
                    <Link
                      className="post-tag global-tag"
                      to={`/categories/${kebabCase(categories.name)}/`}
                      key={categories.name}
                      style={{ color: "#323232" }}
                    >
                      {categories.name}
                    </Link>
                  ))}
                </article>
              </div>
            )
          })}
        </div>
        <div className="membership-footer">
          <Link to="/authors">All Authors</Link>
        </div>
      </div>
    </Layout>
  )
}

export default Author

export const pageQuery = graphql`
  query($author: String) {
    allContentfulBlogPost(
      sort: { fields: updatedAt, order: DESC }
      filter: { author: { name: { eq: $author } } }
    ) {
      totalCount
      edges {
        node {
          id
          title
          slug
          featuredImage {
            fluid {
              ...GatsbyContentfulFluid_withWebp
            }
          }
          author {
            name
          }
          categories {
            name
          }
          excerpt {
            excerpt
          }
          updatedAt(fromNow: true)
        }
      }
    }

    contentfulAuthor(name: { eq: $author }) {
      id
      name
      image {
        fluid {
          ...GatsbyContentfulFluid_withWebp
        }
      }
      intro {
        intro
      }
      facebook
      github
      linkedin
      website
      instagram
    }
  }
`
